<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>zentity - Robust Name Matching</title>
    <meta name="viewport" content="width=device-width, initial-scale=0.8"/>
    <meta name="description" content="zentity brings entity resolution to Elasticsearch. Connect the hidden fragments of an identity in your data. Fast, scalable, open source."/>
    <meta property="og:title" content="zentity - Entity Resolution for Elasticsearch"/>
    <meta property="og:description" content="Connect the hidden fragments of an identity in your data. Fast, scalable, open source."/>
    <meta property="og:image" content="/img/zentity-og-image.png"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://zentity.io/"/>
    <meta name="twitter:title" content="zentity - Entity Resolution for Elasticsearch"/>
    <meta name="twitter:description" content="Connect the hidden fragments of an identity in your data. Fast, scalable, open source."/>
    <link rel="icon" type="image/x-icon" href="/img/favicon.ico"/>
    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet"/>
    <link rel="stylesheet" href="/css/all.css?id=910560064"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-27325874-2"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-27325874-2');
      var to = function(uri, event_category) {
        gtag('event', 'click', {
          'event_category': event_category,
          'event_label': uri,
          'transport_type': 'beacon',
          'event_callback': function(){document.location = uri;}
        });
      };
    </script><script src="/js/all.js?id=996373307"></script>
  </head>
  <body>
    <div id="app" >
      <div id="top"><div id="nav">
          <div style="max-width:950px;margin:0 auto;">
            <a href="/">
              <h1 aria-label="zentity">
                <span style="color:rgb(0,169,224)">z</span><span style="color:rgb(14,119,205)">en</span><span style="color:rgb(31,73,125)">tity</span>
              </h1>
            </a>
            <div id="buttons">
              <a href="/docs">
                <button type="button" class="btn btn-sm btn-primary" aria-label="Docs">
                  Documentation
                </button>
              </a>
              <a href="/releases">
                <button type="button" class="btn btn-sm btn-link" aria-label="Releases">
                  Releases
                </button>
              </a>
              <a href="https://github.com/zentity-io/zentity" title="Github" onclick="to('https://github.com/zentity-io/zentity');">
                <button type="button" class="btn btn-sm btn-link" aria-label="Github">
                  Github
                </button>
              </a>
            </div>
          </div>
        </div></div>
      <div id="main" class="content">
        <p><a href="/">Home</a> / <a href="/docs">Documentation</a> / <a href="/docs/basic-usage">Basic Usage</a> / Robust Name Matching</p>
<h4><a name="contents"></a>Basic Usage Tutorials</h4>
<p>This tutorial is part of a series to help you learn and perform the basic functions of zentity. Each tutorial adds a little more
sophistication to the prior tutorials, so you can start simple and learn the more advanced features over time.</p>
<ol>
<li><a href="/docs/basic-usage/exact-name-matching">Exact Name Matching</a></li>
<li><strong>Robust Name Matching</strong> <em>&#8592; You are here.</em></li>
<li><a href="/docs/basic-usage/multiple-attribute-resolution">Multiple Attribute Resolution</a></li>
<li><a href="/docs/basic-usage/multiple-resolver-resolution">Multiple Resolver Resolution</a></li>
<li><a href="/docs/basic-usage/cross-index-resolution">Cross Index Resolution</a></li>
</ol>
<hr>
<h1><a name="robust-name-matching"></a>Robust Name Matching</h1>
<p>This tutorial adds a little more sophistication to the prior tutorial on <a href="/docs/basic-usage/exact-name-matching">exact name matching</a>.
This time you will map a single attribute to <em>multiple fields</em> of a single index.</p>
<p>Using a one-to-many relationship between attributes and index fields, you can compare the value of an attribute to multiple representations
in the index. Elasticsearch allows you to create <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/multi-fields.html" onclick="to('https://www.elastic.co/guide/en/elasticsearch/reference/current/multi-fields.html', 'outbound');" class="external">subfields</a>
where you can index the same value in different ways. For example, you might want to index a name by its exact value (the
<a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/keyword.html" onclick="to('https://www.elastic.co/guide/en/elasticsearch/reference/current/keyword.html', 'outbound');" class="external"><code>keyword</code></a> data type), its full text value (the
<a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/text.html" onclick="to('https://www.elastic.co/guide/en/elasticsearch/reference/current/text.html', 'outbound');" class="external"><code>text</code></a> data type), or its phonetic encoding using the
<a href="https://www.elastic.co/guide/en/elasticsearch/plugins/current/analysis-phonetic.html" onclick="to('https://www.elastic.co/guide/en/elasticsearch/plugins/current/analysis-phonetic.html', 'outbound');" class="external">phonetic analysis plugin</a>. Elasticsearch
allows you to query any of these representations of the name and return the original value of the name.</p>
<p>You can use this to your advantage with zentity. All you need to do is map the attribute and a matcher to each of those fields.
When you <a href="/docs/rest-apis/resolution-api">submit an entity resolution job</a>, attributes will be compared to every index field to which
they are mapped.</p>
<p>Let's dive in.</p>
<blockquote><p><strong>Important</strong></p>
<p>You must install <a href="https://www.elastic.co/downloads/elasticsearch" onclick="to('https://www.elastic.co/downloads/elasticsearch', 'outbound');" class="external">Elasticsearch</a>, <a href="https://www.elastic.co/downloads/kibana" onclick="to('https://www.elastic.co/downloads/kibana', 'outbound');" class="external">Kibana</a>, and <a href="/docs/installation">zentity</a> to complete this tutorial.
This tutorial was tested with <a href="/docs/releases">zentity-1.0.0-elasticsearch-6.2.4</a>.</p>
</blockquote>
<h2><a name="prepare"></a>1. Prepare for the tutorial</h2>
<h3><a name="install-phonetic-analysis-plugin"></a>1.1. Install the required plugins</h3>
<p>This tutorial uses the <a href="https://www.elastic.co/guide/en/elasticsearch/plugins/current/analysis-phonetic.html" onclick="to('https://www.elastic.co/guide/en/elasticsearch/plugins/current/analysis-phonetic.html', 'outbound');" class="external">phonetic analysis plugin</a>
and <a href="https://www.elastic.co/guide/en/elasticsearch/plugins/current/analysis-icu.html" onclick="to('https://www.elastic.co/guide/en/elasticsearch/plugins/current/analysis-icu.html', 'outbound');" class="external">ICU analysis plugin</a> for Elasticsearch. You will
need to stop Elasticsearch, install these plugin, and start Elasticsearch. You can learn more about Elasticsearch plugin management
<a href="https://www.elastic.co/guide/en/elasticsearch/plugins/current/plugin-management.html" onclick="to('https://www.elastic.co/guide/en/elasticsearch/plugins/current/plugin-management.html', 'outbound');" class="external">here</a>.</p>
<p>For Linux (in the <code>$ES_HOME</code> directory of a .tar.gz installation):</p>

        <div class="code">
          <button type="button" class="btn btn-sm btn-link copy" data-clipboard-target="#af8c5a8bf4b0d79a0">
            <span style="font-size:24px;">&#x2398</span> Copy to clipboard
          </button>
          <span id="af8c5a8bf4b0d79a0"><div class="highlight"><pre><span></span>sudo bin/elasticsearch-plugin install analysis-phonetic
sudo bin/elasticsearch-plugin install analysis-icu
</pre></div>
</span>
        </div>
        <p>For Windows (in the <code>$ES_HOME</code> directory of a .zip installation):</p>

        <div class="code">
          <button type="button" class="btn btn-sm btn-link copy" data-clipboard-target="#a6bfda2983beb7779">
            <span style="font-size:24px;">&#x2398</span> Copy to clipboard
          </button>
          <span id="a6bfda2983beb7779"><div class="highlight"><pre><span></span>bin/elasticsearch-plugin.bat install analysis-phonetic
bin/elasticsearch-plugin.bat install analysis-icu
</pre></div>
</span>
        </div>
        <h3><a name="open-kibana-console-ui"></a>1.2. Open the Kibana Console UI</h3>
<p>The <a href="https://www.elastic.co/guide/en/kibana/current/console-kibana.html" onclick="to('https://www.elastic.co/guide/en/kibana/current/console-kibana.html', 'outbound');" class="external">Kibana Console UI</a> makes it easy to submit requests to Elasticsearch and read responses.</p>
<h3><a name="delete-old-tutorial-indices"></a>1.3. Delete any old tutorial indices</h3>
<p>Let's start from scratch. Delete any tutorial indices you might have created from other tutorials.</p>

        <div class="code">
          <button type="button" class="btn btn-sm btn-link copy" data-clipboard-target="#a0697cbe31616b964">
            <span style="font-size:24px;">&#x2398</span> Copy to clipboard
          </button>
          <span id="a0697cbe31616b964"><div class="highlight"><pre><span></span><span class="nx">DELETE</span> <span class="p">.</span><span class="nx">zentity</span><span class="o">-</span><span class="nx">tutorial</span><span class="o">-*</span>
</pre></div>
</span>
        </div>
        <h3><a name="create-tutorial-index"></a>1.4. Create the tutorial index</h3>
<p>Now create the index for this tutorial.</p>
<p><span class="code-overflow"></span></p>

        <div class="code">
          <button type="button" class="btn btn-sm btn-link copy" data-clipboard-target="#a48d1c13be191a32b">
            <span style="font-size:24px;">&#x2398</span> Copy to clipboard
          </button>
          <span id="a48d1c13be191a32b"><div class="highlight"><pre><span></span><span class="nx">PUT</span> <span class="p">.</span><span class="nx">zentity</span><span class="o">-</span><span class="nx">tutorial</span><span class="o">-</span><span class="nx">index</span>
<span class="p">{</span>
  <span class="s2">&quot;settings&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;index&quot;</span><span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;number_of_shards&quot;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s2">&quot;number_of_replicas&quot;</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="s2">&quot;analysis&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;analyzer&quot;</span><span class="o">:</span> <span class="p">{</span>
          <span class="s2">&quot;clean_analyzer&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;tokenizer&quot;</span><span class="o">:</span> <span class="s2">&quot;standard&quot;</span><span class="p">,</span>
            <span class="s2">&quot;filter&quot;</span><span class="o">:</span> <span class="p">[</span>
              <span class="s2">&quot;icu_normalizer&quot;</span><span class="p">,</span>
              <span class="s2">&quot;icu_folding&quot;</span>
            <span class="p">]</span>
          <span class="p">},</span>
          <span class="s2">&quot;phonetic_analyzer&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;tokenizer&quot;</span><span class="o">:</span> <span class="s2">&quot;standard&quot;</span><span class="p">,</span>
            <span class="s2">&quot;filter&quot;</span><span class="o">:</span> <span class="p">[</span>
              <span class="s2">&quot;icu_normalizer&quot;</span><span class="p">,</span>
              <span class="s2">&quot;icu_folding&quot;</span><span class="p">,</span>
              <span class="s2">&quot;phonetic_filter&quot;</span>
            <span class="p">]</span>
          <span class="p">}</span>
        <span class="p">},</span>
        <span class="s2">&quot;filter&quot;</span><span class="o">:</span> <span class="p">{</span>
          <span class="s2">&quot;phonetic_filter&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;phonetic&quot;</span><span class="p">,</span>
            <span class="s2">&quot;encoder&quot;</span><span class="o">:</span> <span class="s2">&quot;nysiis&quot;</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;mapping&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;doc&quot;</span><span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;properties&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="p">{</span>
          <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;keyword&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;user&quot;</span><span class="o">:</span> <span class="p">{</span>
          <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span>
          <span class="s2">&quot;fields&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;phonetic&quot;</span><span class="o">:</span> <span class="p">{</span>
              <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span>
              <span class="s2">&quot;analyzer&quot;</span><span class="o">:</span> <span class="s2">&quot;clean&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;phonetic&quot;</span><span class="o">:</span> <span class="p">{</span>
              <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span>
              <span class="s2">&quot;analyzer&quot;</span><span class="o">:</span> <span class="s2">&quot;phonetic&quot;</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">},</span>
        <span class="s2">&quot;phone&quot;</span><span class="o">:</span> <span class="p">{</span>
          <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span>
          <span class="s2">&quot;fields&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;keyword&quot;</span><span class="o">:</span> <span class="p">{</span>
              <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;keyword&quot;</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">},</span>
        <span class="s2">&quot;email&quot;</span><span class="o">:</span> <span class="p">{</span>
          <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span>
          <span class="s2">&quot;fields&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;keyword&quot;</span><span class="o">:</span> <span class="p">{</span>
              <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;keyword&quot;</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">},</span>
        <span class="s2">&quot;dob&quot;</span><span class="o">:</span> <span class="p">{</span>
          <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;date&quot;</span><span class="p">,</span>
          <span class="s2">&quot;format&quot;</span><span class="o">:</span> <span class="s2">&quot;yyyy-MM-dd&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;zip&quot;</span><span class="o">:</span> <span class="p">{</span>
          <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;integer&quot;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</span>
        </div>
        <p>Notice that this index defines multiple fields under the <code>user</code> field. There are three fields we can query for the <code>user</code>:</p>
<ul>
<li><code>user</code> uses the standard analyzer.</li>
<li><code>user.clean</code> uses a custom analyzer called <code>clean_analyzer</code>.</li>
<li><code>user.phonetic</code> uses a custom analyzer called <code>phonetic_analyzer</code>.</li>
</ul>
<p>We defined <code>clean_analyzer</code> and <code>phonetic_analyzer</code> in the settings of the index. <code>clean_analyzer</code> uses the <code>icu_normalizer</code> and <code>icu_folding</code>
filters to convert any accented Unicode characters to their ASCII equivalent and normalize the casing of the characters. <code>phonetic_analyzer</code>
does the same thing, and then it transforms the tokens of the value into their phonetic representations using the <code>nysiis</code> phonetic encoding
algorithm.</p>
<blockquote><p><strong>Tip</strong></p>
<p>Analyzers are powerful tools to improve the accuracy of entity resolution. But they come with costs. The first cost is performance. Whenever
a query is submitting to Elasticsearch, the analyzers will process the input values. zentity can submit many queries in a single entity resolution job,
and the overall performance of a job can degrade significantly if you use regular expressions or other compute intensive filters in your analyzers.
The second cost is flexibility. You can't change the analyzers of fields without reindexing the data to an index with different analyzers. So you
should put careful thought into your analyzers and test them before using them in production.</p>
</blockquote>
<p>Let's see how these analyzers produce different tokens for the same value.</p>
<h4>Example of <code>clean_analyzer</code></h4>
<p><strong>Request</strong></p>

        <div class="code">
          <button type="button" class="btn btn-sm btn-link copy" data-clipboard-target="#aa7215e4ba268fee8">
            <span style="font-size:24px;">&#x2398</span> Copy to clipboard
          </button>
          <span id="aa7215e4ba268fee8"><div class="highlight"><pre><span></span><span class="nx">POST</span> <span class="p">.</span><span class="nx">zentity</span><span class="o">-</span><span class="nx">tutorial</span><span class="o">-</span><span class="nx">index</span><span class="o">/</span><span class="nx">_analyze</span>
<span class="p">{</span> <span class="s2">&quot;text&quot;</span><span class="o">:</span> <span class="s2">&quot;Alice Jones-Smith&quot;</span><span class="p">,</span> <span class="s2">&quot;analyzer&quot;</span><span class="o">:</span> <span class="s2">&quot;clean&quot;</span> <span class="p">}</span>
</pre></div>
</span>
        </div>
        <p><strong>Response</strong></p>

        <div class="code">
          <button type="button" class="btn btn-sm btn-link copy" data-clipboard-target="#aa14f65cb48442519">
            <span style="font-size:24px;">&#x2398</span> Copy to clipboard
          </button>
          <span id="aa14f65cb48442519"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;tokens&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;token&quot;</span><span class="o">:</span> <span class="s2">&quot;alice&quot;</span><span class="p">,</span>
      <span class="s2">&quot;start_offset&quot;</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="s2">&quot;end_offset&quot;</span><span class="o">:</span> <span class="mi">5</span><span class="p">,</span>
      <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;&lt;ALPHANUM&gt;&quot;</span><span class="p">,</span>
      <span class="s2">&quot;position&quot;</span><span class="o">:</span> <span class="mi">0</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;token&quot;</span><span class="o">:</span> <span class="s2">&quot;jones&quot;</span><span class="p">,</span>
      <span class="s2">&quot;start_offset&quot;</span><span class="o">:</span> <span class="mi">6</span><span class="p">,</span>
      <span class="s2">&quot;end_offset&quot;</span><span class="o">:</span> <span class="mi">11</span><span class="p">,</span>
      <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;&lt;ALPHANUM&gt;&quot;</span><span class="p">,</span>
      <span class="s2">&quot;position&quot;</span><span class="o">:</span> <span class="mi">1</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;token&quot;</span><span class="o">:</span> <span class="s2">&quot;smith&quot;</span><span class="p">,</span>
      <span class="s2">&quot;start_offset&quot;</span><span class="o">:</span> <span class="mi">12</span><span class="p">,</span>
      <span class="s2">&quot;end_offset&quot;</span><span class="o">:</span> <span class="mi">17</span><span class="p">,</span>
      <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;&lt;ALPHANUM&gt;&quot;</span><span class="p">,</span>
      <span class="s2">&quot;position&quot;</span><span class="o">:</span> <span class="mi">2</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</span>
        </div>
        <h4>Example of <code>phonetic_analyzer</code></h4>
<p><strong>Request</strong></p>

        <div class="code">
          <button type="button" class="btn btn-sm btn-link copy" data-clipboard-target="#af2d712fa52ee3be0">
            <span style="font-size:24px;">&#x2398</span> Copy to clipboard
          </button>
          <span id="af2d712fa52ee3be0"><div class="highlight"><pre><span></span><span class="nx">POST</span> <span class="p">.</span><span class="nx">zentity</span><span class="o">-</span><span class="nx">tutorial</span><span class="o">-</span><span class="nx">index</span><span class="o">/</span><span class="nx">_analyze</span>
<span class="p">{</span> <span class="s2">&quot;text&quot;</span><span class="o">:</span> <span class="s2">&quot;Alice Jones-Smith&quot;</span><span class="p">,</span> <span class="s2">&quot;analyzer&quot;</span><span class="o">:</span> <span class="s2">&quot;phonetic&quot;</span> <span class="p">}</span>
</pre></div>
</span>
        </div>
        <p><strong>Response</strong></p>

        <div class="code">
          <button type="button" class="btn btn-sm btn-link copy" data-clipboard-target="#a1bd6b8a170be0e04">
            <span style="font-size:24px;">&#x2398</span> Copy to clipboard
          </button>
          <span id="a1bd6b8a170be0e04"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;tokens&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;token&quot;</span><span class="o">:</span> <span class="s2">&quot;ALAC&quot;</span><span class="p">,</span>
      <span class="s2">&quot;start_offset&quot;</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="s2">&quot;end_offset&quot;</span><span class="o">:</span> <span class="mi">5</span><span class="p">,</span>
      <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;&lt;ALPHANUM&gt;&quot;</span><span class="p">,</span>
      <span class="s2">&quot;position&quot;</span><span class="o">:</span> <span class="mi">0</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;token&quot;</span><span class="o">:</span> <span class="s2">&quot;JAN&quot;</span><span class="p">,</span>
      <span class="s2">&quot;start_offset&quot;</span><span class="o">:</span> <span class="mi">6</span><span class="p">,</span>
      <span class="s2">&quot;end_offset&quot;</span><span class="o">:</span> <span class="mi">11</span><span class="p">,</span>
      <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;&lt;ALPHANUM&gt;&quot;</span><span class="p">,</span>
      <span class="s2">&quot;position&quot;</span><span class="o">:</span> <span class="mi">1</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;token&quot;</span><span class="o">:</span> <span class="s2">&quot;SNAT&quot;</span><span class="p">,</span>
      <span class="s2">&quot;start_offset&quot;</span><span class="o">:</span> <span class="mi">12</span><span class="p">,</span>
      <span class="s2">&quot;end_offset&quot;</span><span class="o">:</span> <span class="mi">17</span><span class="p">,</span>
      <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;&lt;ALPHANUM&gt;&quot;</span><span class="p">,</span>
      <span class="s2">&quot;position&quot;</span><span class="o">:</span> <span class="mi">2</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</span>
        </div>
        <h3><a name="load-tutorial-data"></a>1.5. Load the tutorial data</h3>
<p>Add the tutorial data to the index.</p>

        <div class="code">
          <button type="button" class="btn btn-sm btn-link copy" data-clipboard-target="#ab73fd7fd9d976259">
            <span style="font-size:24px;">&#x2398</span> Copy to clipboard
          </button>
          <span id="ab73fd7fd9d976259"><div class="highlight"><pre><span></span><span class="nx">POST</span> <span class="p">.</span><span class="nx">zentity</span><span class="o">-</span><span class="nx">tutorial</span><span class="o">-</span><span class="nx">index</span><span class="o">/</span><span class="nx">_bulk</span>
<span class="p">{</span>
  <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</span>
        </div>
        <p>Here's what the tutorial data looks like.</p>
<table class="table">
<thead><tr>
<th style="text-align:left">id</th>
<th style="text-align:left">user</th>
<th style="text-align:left">phone</th>
<th style="text-align:left">email</th>
<th style="text-align:left">dob</th>
<th style="text-align:left">zip</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:left">Alice</td>
<td style="text-align:left">555-123-4567</td>
<td style="text-align:left">alice@example.net</td>
<td style="text-align:left">1984-01-01</td>
<td style="text-align:left">90210</td>
</tr>
<tr>
<td style="text-align:left">2</td>
<td style="text-align:left">Alice</td>
<td style="text-align:left">555-123-4567</td>
<td style="text-align:left">alice@example.net</td>
<td style="text-align:left">1984-01-01</td>
<td style="text-align:left">90210</td>
</tr>
<tr>
<td style="text-align:left">3</td>
<td style="text-align:left">Elise</td>
<td style="text-align:left">555-987-6543</td>
<td style="text-align:left">elise@example.com</td>
<td style="text-align:left">1984-01-01</td>
<td style="text-align:left">90210</td>
</tr>
<tr>
<td style="text-align:left">4</td>
<td style="text-align:left">Bob</td>
<td style="text-align:left">555-555-5555</td>
<td style="text-align:left">bob@example.net</td>
<td style="text-align:left">1989-05-15</td>
<td style="text-align:left">90210</td>
</tr>
</tbody>
</table>
<h2><a name="create-entity-model"></a>2. Create the entity model</h2>
<p>Let's use the <a href="/docs/rest-apis/models-api">Models API</a> to create the entity model below. We'll review each part of the model in depth.</p>

        <div class="code">
          <button type="button" class="btn btn-sm btn-link copy" data-clipboard-target="#a0ab6aa5afee26861">
            <span style="font-size:24px;">&#x2398</span> Copy to clipboard
          </button>
          <span id="a0ab6aa5afee26861"><div class="highlight"><pre><span></span><span class="nx">PUT</span> <span class="nx">_zentity</span><span class="o">/</span><span class="nx">models</span><span class="o">/</span><span class="nx">zentity</span><span class="o">-</span><span class="nx">tutorial</span><span class="o">-</span><span class="nx">person</span>
<span class="p">{</span>
  <span class="s2">&quot;attributes&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;resolvers&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;name_only&quot;</span><span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;attributes&quot;</span><span class="o">:</span> <span class="p">[</span> <span class="s2">&quot;name&quot;</span> <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;matchers&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;simple&quot;</span><span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;clause&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;match&quot;</span><span class="o">:</span> <span class="p">{</span>
          <span class="s2">&quot;{{ field }}&quot;</span><span class="o">:</span> <span class="s2">&quot;{{ value }}&quot;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;fuzzy&quot;</span><span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;clause&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;match&quot;</span><span class="o">:</span> <span class="p">{</span>
          <span class="s2">&quot;{{ field }}&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;query&quot;</span><span class="o">:</span> <span class="s2">&quot;{{ value }}&quot;</span><span class="p">,</span>
            <span class="s2">&quot;fuzziness&quot;</span><span class="o">:</span> <span class="s2">&quot;auto&quot;</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;indices&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;.zentity-tutorial-index&quot;</span><span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;fields&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;user&quot;</span><span class="o">:</span> <span class="p">{</span>
          <span class="s2">&quot;attribute&quot;</span><span class="o">:</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span>
          <span class="s2">&quot;matcher&quot;</span><span class="o">:</span> <span class="s2">&quot;fuzzy&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;user.clean&quot;</span><span class="o">:</span> <span class="p">{</span>
          <span class="s2">&quot;attribute&quot;</span><span class="o">:</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span>
          <span class="s2">&quot;matcher&quot;</span><span class="o">:</span> <span class="s2">&quot;simple&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;user.phonetic&quot;</span><span class="o">:</span> <span class="p">{</span>
          <span class="s2">&quot;attribute&quot;</span><span class="o">:</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span>
          <span class="s2">&quot;matcher&quot;</span><span class="o">:</span> <span class="s2">&quot;simple&quot;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</span>
        </div>
        <h3><a name="review-attributes"></a>2.1. Review the attributes</h3>
<p>We defined a single attribute called <code>"name"</code> as shown in this section:</p>

        <div class="code">
          <button type="button" class="btn btn-sm btn-link copy" data-clipboard-target="#a7c45a679060150b3">
            <span style="font-size:24px;">&#x2398</span> Copy to clipboard
          </button>
          <span id="a7c45a679060150b3"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;attributes&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</span>
        </div>
        <p>This is identical to the <code>"attributes"</code> field of the entity model in the <a href="/docs/basic-usage/exact-name-matching#create-entity-model">exact name matching</a> tutorial.</p>
<h3><a name="review-resolvers"></a>2.2. Review the resolvers</h3>
<p>We defined a single resolver called <code>"name_only"</code> as shown in this section:</p>

        <div class="code">
          <button type="button" class="btn btn-sm btn-link copy" data-clipboard-target="#a42d66931996af468">
            <span style="font-size:24px;">&#x2398</span> Copy to clipboard
          </button>
          <span id="a42d66931996af468"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;resolvers&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;name_only&quot;</span><span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;attributes&quot;</span><span class="o">:</span> <span class="p">[</span> <span class="s2">&quot;name&quot;</span> <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</span>
        </div>
        <p>This is identical to the <code>"resolvers"</code> field of the entity model in the <a href="/docs/basic-usage/exact-name-matching#create-entity-model">exact name matching</a> tutorial.</p>
<blockquote><p><strong>Tip</strong></p>
<p>Most resolvers should use multiple attributes to resolve an entity to minimize false positives. Many people share the same name,
but few people share the same name and address. Consider all the combinations of attributes that could resolve an entity with confidence,
and then create a resolver for each combination. <a href="/docs/basic-usage">Other tutorials</a> explore how to use resolvers with multiple attributes.</p>
</blockquote>
<h3><a name="review-matchers"></a>2.3. Review the matchers</h3>
<p>We defined two matchers called <code>"simple"</code> and <code>"fuzzy"</code> as shown in this section:</p>

        <div class="code">
          <button type="button" class="btn btn-sm btn-link copy" data-clipboard-target="#a9fb6584c860cbe73">
            <span style="font-size:24px;">&#x2398</span> Copy to clipboard
          </button>
          <span id="a9fb6584c860cbe73"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;matchers&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;simple&quot;</span><span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;clause&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;match&quot;</span><span class="o">:</span> <span class="p">{</span>
          <span class="s2">&quot;{{ field }}&quot;</span><span class="o">:</span> <span class="s2">&quot;{{ value }}&quot;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;fuzzy&quot;</span><span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;clause&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;match&quot;</span><span class="o">:</span> <span class="p">{</span>
          <span class="s2">&quot;{{ field }}&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;query&quot;</span><span class="o">:</span> <span class="s2">&quot;{{ value }}&quot;</span><span class="p">,</span>
            <span class="s2">&quot;fuzziness&quot;</span><span class="o">:</span> <span class="s2">&quot;auto&quot;</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</span>
        </div>
        <p>The <code>"simple"</code> matcher uses a simple <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-match-query.html" onclick="to('https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-match-query.html', 'outbound');" class="external"><code>match</code> clause</a>:</p>

        <div class="code">
          <button type="button" class="btn btn-sm btn-link copy" data-clipboard-target="#a62ff3a9befa99644">
            <span style="font-size:24px;">&#x2398</span> Copy to clipboard
          </button>
          <span id="a62ff3a9befa99644"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;match&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;{{ field }}&quot;</span><span class="o">:</span> <span class="s2">&quot;{{ value }}&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</span>
        </div>
        <p>The <code>"fuzzy"</code> matcher uses a <code>match</code> clause with the <a href="https://www.elastic.co/guide/en/elasticsearch/guide/current/fuzzy-match-query.html" onclick="to('https://www.elastic.co/guide/en/elasticsearch/guide/current/fuzzy-match-query.html', 'outbound');" class="external"><code>fuzziness</code></a> parameter,
which matches values with minor dissimilarities such as typos. Elasticsearch uses the <a href="https://www.elastic.co/guide/en/elasticsearch/guide/current/fuzziness.html" onclick="to('https://www.elastic.co/guide/en/elasticsearch/guide/current/fuzziness.html', 'outbound');" class="external">Damerau-Levenshtein edit distance</a>
to perform this match.</p>

        <div class="code">
          <button type="button" class="btn btn-sm btn-link copy" data-clipboard-target="#af0a5566ca1d55167">
            <span style="font-size:24px;">&#x2398</span> Copy to clipboard
          </button>
          <span id="af0a5566ca1d55167"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;match&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;{{ field }}&quot;</span><span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;query&quot;</span><span class="o">:</span> <span class="s2">&quot;{{ value }}&quot;</span>
      <span class="s2">&quot;fuzziness&quot;</span><span class="o">:</span> <span class="s2">&quot;auto&quot;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</span>
        </div>
        <p>The <code>"{{ field }}"</code> and <code>"{{ value }}"</code> strings are special variables. Every matcher should have these variables defined somewhere
in the <code>"clause"</code> field. zentity will replace the <code>"{{ field }}"</code> variable with the name of an index field and the <code>"{{ value }}"</code>
variable with the value of an attribute.</p>
<h3><a name="review-indices"></a>2.4. Review the indices</h3>
<p>We defined a single index as shown in this section:</p>

        <div class="code">
          <button type="button" class="btn btn-sm btn-link copy" data-clipboard-target="#a10d75875d83218a1">
            <span style="font-size:24px;">&#x2398</span> Copy to clipboard
          </button>
          <span id="a10d75875d83218a1"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;indices&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;.zentity-tutorial-index&quot;</span><span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;fields&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;user&quot;</span><span class="o">:</span> <span class="p">{</span>
          <span class="s2">&quot;attribute&quot;</span><span class="o">:</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span>
          <span class="s2">&quot;matcher&quot;</span><span class="o">:</span> <span class="s2">&quot;fuzzy&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;user.clean&quot;</span><span class="o">:</span> <span class="p">{</span>
          <span class="s2">&quot;attribute&quot;</span><span class="o">:</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span>
          <span class="s2">&quot;matcher&quot;</span><span class="o">:</span> <span class="s2">&quot;simple&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;user.phonetic&quot;</span><span class="o">:</span> <span class="p">{</span>
          <span class="s2">&quot;attribute&quot;</span><span class="o">:</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span>
          <span class="s2">&quot;matcher&quot;</span><span class="o">:</span> <span class="s2">&quot;simple&quot;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</span>
        </div>
        <p>We mapped the <code>"name"</code> attribute to the <code>"user"</code>, <code>"user.clean"</code>, and <code>"user.phonetic"</code> fields in <code>.zentity-tutorial-index</code>.
The <code>"user"</code> field will use the <code>"fuzzy"</code> matcher and the other two fields will use the <code>"simple"</code> matcher.</p>
<h2><a name="resolve-entity"></a>3. Resolve an entity</h2>
<p>Let's use the <a href="/docs/rest-apis/resolution-api">Resolution API</a> to resolve a person with the name "Alice":</p>

        <div class="code">
          <button type="button" class="btn btn-sm btn-link copy" data-clipboard-target="#af9c8eaf6c57b95fe">
            <span style="font-size:24px;">&#x2398</span> Copy to clipboard
          </button>
          <span id="af9c8eaf6c57b95fe"><div class="highlight"><pre><span></span><span class="nx">POST</span> <span class="nx">_zentity</span><span class="o">/</span><span class="nx">resolution</span><span class="o">/</span><span class="nx">zentity</span><span class="o">-</span><span class="nx">tutorial</span><span class="o">-</span><span class="nx">person</span>
<span class="p">{</span>
  <span class="s2">&quot;attributes&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="p">[</span> <span class="s2">&quot;Alice&quot;</span> <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</span>
        </div>
        <p>The results will look like this:</p>

        <div class="code">
          <button type="button" class="btn btn-sm btn-link copy" data-clipboard-target="#abf47f776c2bc48d6">
            <span style="font-size:24px;">&#x2398</span> Copy to clipboard
          </button>
          <span id="abf47f776c2bc48d6"><div class="highlight"><pre><span></span><span class="p">...</span>
</pre></div>
</span>
        </div>
        <p>As expected, we retrieved ...</p>
<h2><a name="conclusion"></a>Conclusion</h2>
<p>Congratulations! You learned how to map a single attribute to multiple fields in a single index. You also observed how to
perform more robust name matching by using fuzziness, phonetic analyzers, and ICU analyzers.</p>
<p>But we can do better than name matching, right? Lots of people share the same name. How can we improve accuracy?</p>
<p>The next tutorial will introduce <a href="/docs/basic-usage/multiple-attribute-resolution">multiple attribute resolution</a>. You will
resolve an entity using multiple attributes mapped to multiple fields of a single index.</p>
<p>&nbsp;</p>
<hr>
<h4>Continue Reading</h4>
<table class="table">
<thead><tr>
<th style="text-align:left">&#8249;</th>
<th style="text-align:left"><a href="/docs/basic-usage/exact-name-matching">Exact Name Matching</a></th>
<th style="text-align:right"><a href="/docs/basic-usage/multiple-attribute-resolution">Multiple Attribute Resolution</a></th>
<th style="text-align:right">&#8250;</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table>

      </div>
      <div id="bottom">
        <small>
          <div>
            &copy; 2018 <a href="https://github.com/davemoore-" title="Dave Moore" onclick="to('https://github.com/davemoore-');">Dave Moore</a>.
          </div>
          <div>
            Licensed under the <a href="http://www.apache.org/licenses/LICENSE-2.0" onclick="to('http://www.apache.org/licenses/LICENSE-2.0');">Apache License, Version 2.0</a>.
          </div>
          <div>
            Elasticsearch is a trademark of Elasticsearch BV.
          </div>
          <div>
            This website uses Google Analytics.</div>
        </small>
      </div>
    </div>
  </body>
  <script>$(document).ready(function(){ new ClipboardJS('.copy'); });</script>
</html>
